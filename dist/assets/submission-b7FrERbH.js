/* empty css               */import{initializeApp as P}from"https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";import{getAuth as q,GoogleAuthProvider as A,onAuthStateChanged as F,signOut as D,signInWithPopup as C}from"https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function u(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(e){if(e.ep)return;e.ep=!0;const t=u(e);fetch(e.href,t)}})();const H={apiKey:"AIzaSyBsXDjDbuN5v1Dwx0kBIK6wmvLm8TC1Ei8",authDomain:"journal-399f6.firebaseapp.com",projectId:"journal-399f6",storageBucket:"journal-399f6.firebasestorage.app",messagingSenderId:"401502770070",appId:"1:401502770070:web:9017cb9a6e868951ee43b7"},T=P(H),g=q(T),j=new A,M="https://script.google.com/macros/s/AKfycbwH9ql3P_iGSS0Ni0_Yl5yKDYQbu_PskFHz9FsGLRyuU_JGc3pluGabKaooB07uJzln/exec";function N(){return"SUB-"+Date.now()}F(g,a=>{const i=document.getElementById("login-section"),u=document.getElementById("submission-form-container"),s=document.getElementById("user-panel"),e=document.getElementById("user-avatar"),t=document.getElementById("user-email"),n=document.getElementById("submit-nav-btn");if(a){s&&(s.style.display="flex"),e&&(e.src=a.photoURL||"https://ui-avatars.com/api/?name="+a.email),t&&(t.textContent=a.email),n&&(n.style.display="none"),i.style.display="none",u.style.display="block";const m=document.getElementById("corresp-email");m&&(m.value=a.email)}else s&&(s.style.display="none"),n&&(n.style.display="block"),i.style.display="block",u.style.display="none"});const k=document.getElementById("logout-btn");k&&k.addEventListener("click",()=>{D(g).then(()=>{window.location.reload()})});window.loginWithGoogle=async()=>{try{await C(g,j)}catch{alert("Login failed")}};const b=document.getElementById("agree-checkbox"),v=document.getElementById("login-google-btn");b&&v&&(b.addEventListener("change",()=>{v.disabled=!b.checked}),v.addEventListener("click",()=>{window.loginWithGoogle()}));const L=document.getElementById("manuscript-form");L&&L.addEventListener("submit",async a=>{a.preventDefault(),console.log("Form submission initiated");const i=g.currentUser;if(!i){alert("Please login with Google first to submit your manuscript.");return}const u=document.getElementById("manuscript-title")?.value,s=document.getElementById("manuscript-abstract")?.value,e=document.getElementById("article-type")?.value,t=document.getElementById("subject-area")?.value,n=document.getElementById("file-input"),m=document.getElementById("keywords-hidden")?.value,x=document.querySelectorAll('#step-wrapper-4 input[type="checkbox"]');let E=!0;if(x.forEach(o=>{o.checked||(E=!1)}),!u||!s||!e||!t){alert("Please complete all required fields in Step 1: Manuscript Details.");const o=document.querySelector("#step-wrapper-1 .step-header");o&&o.click();return}if(!n||!n.files.length){alert("Please upload your manuscript file in Step 1.");const o=document.querySelector("#step-wrapper-1 .step-header");o&&o.click();return}if(!m||m.split(",").length<3){alert("Please add at least 3 keywords in Step 2.");const o=document.querySelector("#step-wrapper-2 .step-header");o&&o.click();return}if(!E){alert("Please confirm all declarations in Step 4 before submitting.");return}const c=document.getElementById("submit-btn"),_=c?c.innerHTML:"Submit Manuscript";try{c&&(c.innerHTML='<i class="fas fa-spinner fa-spin"></i> Submitting...',c.disabled=!0);const o=N(),r=new FormData;r.append("submission_id",o),r.append("logged_in_email",i.email),r.append("manuscript_title",u),r.append("abstract",s),r.append("article_type",e),r.append("subject_area",t),r.append("keywords",m);const f=n.files[0];if(!f){alert("Manuscript file missing");return}const w=await new Promise((l,y)=>{const d=new FileReader;d.onload=()=>{const p=d.result;p||y("Failed to read file"),l(p.split(",")[1])},d.onerror=()=>y("File read error"),d.readAsDataURL(f)});r.append("pdf_base64",w),r.append("pdf_filename",f.name),console.log("File name:",f.name),console.log("File base64 length:",w.length);const h=[];h.push({order:1,role:"Corresponding",first_name:document.getElementById("corresp-first-name")?.value||"",last_name:document.getElementById("corresp-last-name")?.value||"",published_name:document.getElementById("corresp-pub-name")?.value||"",email:i.email,orcid:document.getElementById("corresp-orcid")?.value||"",country:document.getElementById("corresp-country")?.value||"",department:document.getElementById("corresp-dept")?.value||"",organization:document.getElementById("corresp-org")?.value||"",position:document.getElementById("corresp-pos")?.value||""}),document.querySelectorAll("#co-authors-accordion-list .author-accordion-item").forEach((l,y)=>{const d=l.querySelector(".co-author-first-name")?.value||"",p=l.querySelector(".co-author-last-name")?.value||"";(d||p)&&h.push({order:y+2,role:"Co-Author",first_name:d,last_name:p,email:l.querySelector(".co-author-email")?.value||"",orcid:l.querySelector(".co-author-orcid")?.value||"",country:l.querySelector(".co-author-country")?.value||"",department:l.querySelector(".co-author-dept")?.value||"",organization:l.querySelector(".co-author-aff")?.value||"",position:""})}),r.append("authors",JSON.stringify(h)),console.log("üì§ Sending submission to Apps Script...");const I=await fetch(M,{method:"POST",body:r});if(!I.ok)throw new Error("Server responded with error");const S=await I.json();if(!S.success)throw new Error(S.error||"Unknown server error");alert("‚úÖ Manuscript submitted successfully!");const B=document.getElementById("submission-form-container");B&&(B.innerHTML=`
            <div style="text-align:center;padding:60px 40px;">
                <div style="width:80px;height:80px;background:#dcfce7;color:#16a34a;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 24px;font-size:40px;">
                    <i class="fas fa-check"></i>
                </div>
                <h2>Submission Successful</h2>
                <p>Your manuscript has been submitted successfully.</p>
                <a href="index.html" class="btn-primary">Return to Home</a>
            </div>
        `),window.scrollTo({top:0,behavior:"smooth"})}catch(o){console.error("Submission Error:",o),alert("‚ùå Submission failed: "+o.message),c&&(c.innerHTML=_,c.disabled=!1)}});
